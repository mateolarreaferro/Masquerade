{
	# Standard HTTPS and HTTP ports - these are the defaults for Caddy
	http_port 25571
	https_port 25571
	admin off
}

:25571 {
	# Use HTTPS by default (Caddy will automatically obtain and manage certificates)
	
	# Frontend - Next.js API routes
	handle_path /api* {
		reverse_proxy localhost:3001
	}

	# Socket.IO with WebSocket support
	handle_path /socket.io* {
		@ws {
			header Connection *Upgrade*
			header Upgrade websocket
		}
		
		# Handle WebSocket traffic
		reverse_proxy @ws localhost:3001 {
			transport http {
				keepalive 30s
			}
		}
		
		# Handle regular HTTP traffic
		reverse_proxy localhost:3001 {
			header_up Host {host}
			header_up X-Real-IP {remote}
		}
	}

	# Frontend - serve Next.js app
	handle {
		reverse_proxy localhost:3000
	}

	log {
		output file /Users/gdmagana/Developer/Github/Masquerade/caddy/access.log
		format console
	}
}

# You can check the CaddyServer wiki at https://caddyserver.com/docs/caddyfile/.
